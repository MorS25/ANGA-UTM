<!DOCTYPE html>
{% extends "base.html" %}

      {% load static %}
      {% load leaflet_tags %}
{% block head %}

      {%  leaflet_js %}
      {%  leaflet_css %}


      <link href='https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/leaflet.fullscreen.css' rel='stylesheet' />

<title>Airspace</title>
{% endblock %}

{% block body %}
<link rel="stylesheet" href="{% static 'leaflet-search/src/leaflet-search.css' %}">


<!-- <section class="content-header">
  <h4>
      Drone Airspace
    <small>Summary</small>
  </h4>
  <ol class="breadcrumb">
    <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
    <li class="active"><a href="">All Applications</a></li>
  </ol>
</section> -->



<section class="content">

  {% if user.is_authenticated %}

  <div class="row">
    <div class="col-xs-4">
      <div class="pull-left">
        <a href="{%url 'create_reserve'%}" >
          Create Flight Plan
          <i class="fa fa-arrow-right" aria-hidden="true"></i>
        </a>
      </div>
    </div>
    <div class="col-xs-4">
        <div class="text-center">
          <a href="{%url 'home'%}" >
            <i class="fa fa-home fa-2x" aria-hidden="true"></i>
            Home
          </a>
        </div>

    </div>
    <div class="col-xs-4">
      <div class="pull-right">
        <a href="{%url 'logs_list'%}" >
          Go to Flight Logs
          <i class="fa fa-arrow-right" aria-hidden="true"></i>
        </a>
      </div>

    </div>

  </div>

  {% endif %}

<div class="row" >

    <div class="panel panel-primary" >
        <!-- <div class="panel-heading"> <small>Maps | Geofences | Corridors | Highways</small></div> -->
      <div class="panel-body" >
        <!-- {{airspaces.0.created_by}} -->

          {% load geojson_tags %}
            <script type="text/javascript">

            bounds = new L.LatLngBounds(new L.LatLng(4.740950, 41.858445), new L.LatLng(-4.921208,  33.922226));

              function our_layers(map,options){

                // center: bounds.getCenter(),
                //
			          //  maxBounds: bounds,



              {% include 'notams/includes/notam_datasets.html' %}
              {% include 'applications/includes/location.html'%}


              {% include 'maps/includes/geofence_datasets.html'%}
              {% include 'applications/includes/reserved_airspace_datasets.html' %}

              {% include 'maps/includes/location_datasets.html'%}


              {% include 'maps/includes/obstacles_datasets.html' %}





              {% include 'applications/includes/search.html' %}



              var latlngs = L.rectangle(bounds).getLatLngs();
              // L.polyline(latlngs[0].concat(latlngs[0][0])).addTo(map);
              map.setMaxBounds(bounds);	// Should not enter infinite recursion

              map.addControl(new L.Control.Fullscreen());


} //end function




            </script>

          {%  leaflet_map "gis" callback="window.our_layers" %}




<script type="text/javascript" src="{% static 'dist/leaflet.ajax.js' %}" ></script>

<script type="text/javascript" src="{% static 'leaflet-search/src/leaflet-search-geocoder.js' %}" ></script>
<script type="text/javascript" src="{% static 'leaflet-search/src/leaflet-search.js' %}" ></script>

<script src='https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/Leaflet.fullscreen.min.js'></script>


      </div>
    </div>

</div>


    <style type="text/css">
      #gis{height:75vh}
    </style>

    <!-- <style>
            #gis {
               margin: 0;
               padding: 0;
               width: 100%;
               height: 100%;
           }
       </style> -->

</section>



<cdn>
  <script src='https://api.mapbox.com/mapbox-gl-js/v0.44.2/mapbox-gl.js'></script>
  <link href='https://api.mapbox.com/mapbox-gl-js/v0.44.2/mapbox-gl.css' rel='stylesheet' />
</cdn>

<div id='map' style='width: 400px; height: 300px;'></div>
<script>
  mapboxgl.accessToken = 'pk.eyJ1IjoiZ2VvZmZyZXlueWFnYSIsImEiOiJjamdmM3Q5NG4wdnprMnhyMGJqd3U1N25yIn0.R_3l_E-DDVpHQ0rL3zgElQ';
  var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/streets-v10'
  });
</script>

{% endblock %}
